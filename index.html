<!doctype html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <base href="https://narikraus.github.io/Rogue-like-RPG/" target="_blank">

        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="assets/css/style.css" rel="stylesheet">

        <title>Hello, world!</title>
    </head>
    <body class="light">
        <nav class="position-absolute navbar navbar-light">
            <div class="container-fluid">
                <button class="navbar-toggler bg-white" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item dropdown">
                            <a class="nav-link light dropdown-toggle" href="#" id="ColourDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                Colour
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="ColourDropdown">
                                <li><button class="dropdown-item active" onclick="$(this).parent().parent().find('.active').removeClass('active');$(this).addClass('active');$('.dark').removeClass('dark').addClass('light');">Light Mode</button></li>
                                <li><button class="dropdown-item" onclick="$(this).parent().parent().find('.active').removeClass('active');$(this).addClass('active');$('.light').removeClass('light').addClass('dark');">Dark Mode</button></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <div class="row">
            <div class="col">
                <div class="container">
                    <div class="align-content-center justify-content-center row" style="height: 100vh;">
        
                        <div class="pixel light"></div>
                        <div class="pixel light"></div>
                        <button disabled id="button-up" class="pixel light up h4" onclick="go(room, 'up')">up</button>
                        <div class="pixel light"></div>
                        <div class="pixel light"></div>
                        
                        <div class="w-100"></div>
        
                        <div class="pixel light"></div>
                        <button disabled class="pixel light middle" id="shop">
                            <div class="h5" id="shop-item"></div>
                            <div class="h5" id="shop-price"></div>
                        </button>
                        <div class="pixel light middle"><h2 class="title"></h2></div>
                        <button disabled class="h5 pixel light middle" id="item">
                        </button>
                        <div class="pixel light"></div>
                        
                        <div class="w-100"></div>
        
                        <button disabled id="button-left" class="pixel light left h4" onclick="go(room, 'left')">left</button>
                        <div class="pixel light middle"></div>
                        <button class="pixel light middle" onclick="
                            $(this).attr('id', 'enemy').attr('onclick', '').unbind('click').addClass('h4');
                            switch (window.fade) {
                                case 0:
                                    $(this).html('');
                                    canGo(room);
                                    checkRoom(room);
                                    $('.title').html(window.room);
                                    break;
                                case 1:
                                    blink();
                                    setTimeout(() => {
                                        $(this).html('');
                                        canGo(room);
                                        checkRoom(room);
                                        $('.title').html(window.room);
                                    }, 250);
                                    break;
                                case 2:
                                blink();
                                    setTimeout(() => {
                                        $(this).html('');
                                        canGo(room);
                                        checkRoom(room);
                                        $('.title').html(window.room);
                                    }, 500);
                                    break;
                            };
                        " id="start">
                            <div class="h2">Start</div>
                            <div class="h2">Game</div>
                        </button>
                        <div class="pixel light middle"></div>
                        <button disabled id="button-right" class="pixel light right h4" onclick="go(room, 'right')">right</button>
                        
                        <div class="w-100"></div>
        
                        <div class="pixel light"></div>
                        <button disabled id="attack-l" class="pixel light middle h5"></button>
                        <button disabled id="attack-m" class="pixel light middle h5"></button>
                        <button disabled id="attack-h" class="pixel light middle h5"></button>
                        <div class="pixel light"></div>
                        
                        <div class="w-100"></div>
        
                        <div class="pixel light"></div>
                        <div class="pixel light"></div>
                        <button disabled id="button-down" class="pixel light down h4" onclick="go(room, 'down')">down</button>
                        <div class="pixel light"></div>
                        <div class="pixel light"></div>
                    </div>
                </div>
            </div>
            <div class="col">
                <div class="container">

                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="assets/js/main.js"></script>

        <script src="assets/js/actions.js"></script>

        <script>
            function getData(url, cb) {
                fetch(url)
                .then(response => response.json())
                .then(result => cb(result));
            }

            // getData(url, (data) => console.log({ data }));

            getData("json/armour.json", (data) => armour = data );
            getData("json/player.json", (data) => player = data );
            getData("json/foes.json", (data) => foes = data );
            getData("json/weapons.json", (data) => weapons = data );
            getData("assets/Levels/L1.json", (data) => rooms = data );

        </script>

        <script>
            var fade = 2;
            var room = "5-5";

            function loadmap(level) {
                getData("assets/Levels/" + level + ".json", (data) => window.rooms = data )

                room = "5-5";
                $('.title').html(window.room);
                canGo(window.room);
                checkRoom(window.room);
            };   

            // x = 0
            // while (x != 4) {
            //     selector = Math.floor(Math.random() * (Object.keys(rooms).length - 1));
                
            //     if (rooms[Object.keys(rooms)[selector]]['enemy'].length == 0 && Object.keys(rooms)[selector] != '5-5') {
            //         x += 1;
            //         rooms[Object.keys(rooms)[selector]]['enemy'].push(names[Math.floor(Math.random() * 9)]);
            //     };
            // };
        </script>
    </body>
</html>